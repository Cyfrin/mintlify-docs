---
title: "Reviewing Attack Requests"
description: "What to check when evaluating attack mode requests"
---

When a protocol requests attack mode, the DAO must review the request to ensure it's legitimate. This guide covers what to check and red flags to watch for.

## Monitoring for Requests

Watch for `AgreementStateChanged` events with `ATTACK_REQUESTED` state:

```solidity
event AgreementStateChanged(address indexed agreementAddress, ContractState newState);

// newState = 2 means ATTACK_REQUESTED
```

You can also query pending requests:

```solidity
// Get agreement state
IAttackRegistry.ContractState state = attackRegistry.getAgreementState(agreementAddress);

if (state == ContractState.ATTACK_REQUESTED) {
    // This agreement needs review
}
```

## Review Checklist

### 1. Verify Deployment Method

Check if contracts were deployed via `BattleChainDeployer`:

```solidity
// Get contracts in scope
address[] memory contracts = agreement.getBattleChainScopeAddresses();

for (uint i = 0; i < contracts.length; i++) {
    address deployer = attackRegistry.getContractDeployer(contracts[i]);

    if (deployer == address(0)) {
        // NOT deployed via BattleChainDeployer
        // This is a requestUnderAttackByNonAuthorized() request
        // Requires extra scrutiny
    } else {
        // Deployed via BattleChainDeployer
        // Has on-chain proof of deployment
    }
}
```

### 2. Check for Mainnet Copies

**This is the most critical check.** Verify the contracts aren't copies of existing mainnet protocols:

<Steps>
  <Step title="Get Contract Bytecode">
    Retrieve the bytecode of each contract in scope
  </Step>
  <Step title="Compare to Mainnet">
    Check if identical or near-identical bytecode exists on Ethereum mainnet or other major chains
  </Step>
  <Step title="Check Protocol Claims">
    Verify the protocol name and claimed identity
  </Step>
  <Step title="Research the Protocol">
    Look for social presence, audit reports, team information
  </Step>
</Steps>

### 3. Evaluate Agreement Terms

Review the Safe Harbor agreement for reasonableness:

```solidity
AgreementDetails memory details = agreement.getDetails();

// Check bounty terms
BountyTerms memory terms = details.bountyTerms;
// Are bounty percentages reasonable? (typically 5-15%)
// Are caps appropriate for the expected TVL?

// Check scope
// Is the scope clearly defined?
// Are all necessary contracts included?

// Check contacts
// Are there legitimate contact methods?
// Can the protocol be reached if needed?
```

### 4. Assess Liquidity Appropriateness

Consider whether the deployed liquidity makes sense:

| TVL | Risk Level | Recommendation |
|-----|------------|----------------|
| < $10K | Low | Quick approval, limited attention |
| $10K - $100K | Medium | Standard review |
| $100K - $1M | Higher | Thorough review |
| > $1M | Significant | Extended review, verify legitimacy |

### 5. Verify Agreement Validity

Ensure the agreement was created properly:

```solidity
// Check agreement was created by official factory
bool isValid = safeHarborRegistry.isAgreementValid(agreementAddress);

// Check agreement is adopted
address adopted = safeHarborRegistry.getAgreement(protocolAddress);
// adopted should equal agreementAddress
```

## Red Flags

<Warning>
Watch for these warning signs:

**Copycat Indicators**
- Bytecode matches existing mainnet contracts
- Protocol name mimics a well-known protocol
- No unique features or modifications

**Suspicious Behavior**
- Very high bounty percentages (>25%)
- Extremely high bounty caps for low TVL
- No verifiable contact information
- Request via `requestUnderAttackByNonAuthorized()` with no explanation

**Technical Issues**
- Contracts not in factory's valid agreement list
- Scope includes contracts not owned by the requester
- Agreement terms changed recently (check commitment window)
</Warning>

## Non-BattleChainDeployer Requests

Requests via `requestUnderAttackByNonAuthorized()` require extra scrutiny:

```solidity
// These contracts have no on-chain proof of legitimate deployment
// The requester claims to own them but there's no verification

// Extra checks needed:
// 1. Verify ownership through off-chain means
// 2. Check if the requester has a track record
// 3. Consider requiring additional documentation
// 4. Look for any suspicious patterns
```

## Documentation

Keep records of your review:

- Agreement address reviewed
- Contracts in scope
- Checks performed
- Any concerns identified
- Final decision and rationale

<Card title="Next: Approval Process" icon="arrow-right" href="/dao/approval-process">
  Learn how to approve or reject requests
</Card>
