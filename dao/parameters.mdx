---
title: "Governance Parameters"
description: "Parameters controlled by DAO governance"
---

The DAO controls several parameters that affect how BattleChain operates. This guide covers what can be changed and the implications of each parameter.

## Registry Moderator

The registry moderator address controls approval/rejection of attack requests.

```solidity
// Only the owner can change the registry moderator
function changeRegistryModerator(address newModerator) external onlyOwner;

// Get current moderator
address moderator = attackRegistry.getRegistryModerator();
```

### Considerations

- Should be a multisig or DAO contract
- Responsible for reviewing all attack requests
- Can instantly promote contracts in emergencies
- High-trust role with significant power

## Valid Chains

The registry maintains a list of valid CAIP-2 chain IDs that can be used in agreements.

```solidity
// Set chains as valid (owner only)
function setValidChains(string[] calldata caip2ChainIds) external onlyOwner;

// Set chains as invalid (owner only)
function setInvalidChains(string[] calldata caip2ChainIds) external onlyOwner;

// Check if a chain is valid
bool valid = safeHarborRegistry.isChainValid("eip155:1");
```

### Chain ID Format

BattleChain uses [CAIP-2](https://github.com/ChainAgnostic/CAIPs/blob/main/CAIPs/caip-2.md) chain identifiers:

| Chain | CAIP-2 ID |
|-------|-----------|
| Ethereum Mainnet | `eip155:1` |
| Arbitrum One | `eip155:42161` |
| Optimism | `eip155:10` |
| Base | `eip155:8453` |
| BattleChain Testnet | `eip155:325` |
| BattleChain Mainnet | `eip155:326` |

### When to Add/Remove Chains

**Add chains when:**
- A new EVM chain gains significant adoption
- Protocols request support for a specific chain
- The ecosystem expands to new networks

**Remove chains when:**
- A chain is deprecated or abandoned
- Security concerns arise with a specific chain
- The chain is no longer relevant to the ecosystem

## Contract Constants

These values are set at deployment and cannot be changed without contract upgrade:

```solidity
// Time constants (in AttackRegistry)
uint256 public constant PROMOTION_WINDOW = 14 days;  // Auto-promote deadline
uint256 public constant PROMOTION_DELAY = 3 days;    // Delay after promote()
uint256 public constant MIN_COMMITMENT = 7 days;     // Minimum agreement commitment
```

### Implications

| Constant | Effect |
|----------|--------|
| `PROMOTION_WINDOW` (14 days) | If DAO doesn't act on a request within 14 days, it auto-promotes to production |
| `PROMOTION_DELAY` (3 days) | After `promote()` is called, 3 days must pass before production state |
| `MIN_COMMITMENT` (7 days) | Agreements must commit to terms for at least 7 days to request attack mode |

<Note>
Changing these constants requires a contract upgrade, which is a more significant governance decision than parameter updates.
</Note>

## Agreement Factory

The factory creates new agreements and tracks which agreements are valid.

```solidity
// Set a new agreement factory (owner only)
function setAgreementFactory(address factory) external onlyOwner;

// Get current factory
address factory = safeHarborRegistry.getAgreementFactory();

// Check if agreement is from valid factory
bool valid = agreementFactory.isAgreementContract(agreementAddress);
```

### When to Update

Update the factory when:
- Deploying a new version with bug fixes
- Adding new agreement features
- Changing agreement structure

<Warning>
Changing the factory doesn't invalidate existing agreements. Old agreements remain valid even after factory change.
</Warning>

## Safe Harbor Registry

Links the attack registry to the safe harbor registry.

```solidity
// Set safe harbor registry (owner only)
function setSafeHarborRegistry(address newRegistry) external onlyOwner;

// Get current registry
address registry = attackRegistry.getSafeHarborRegistry();
```

## BattleChain Deployer

The deployer contract that registers new deployments.

```solidity
// Set BattleChain deployer (owner only)
function setBattleChainDeployer(address newDeployer) external onlyOwner;

// Get current deployer
address deployer = attackRegistry.getBattleChainDeployer();
```

## Upgrade Authority

Both `AttackRegistry` and `AgreementFactory` use UUPS upgradeable pattern:

```solidity
// Only the owner can authorize upgrades
function _authorizeUpgrade(address newImplementation) internal override onlyOwner;
```

### Upgrade Considerations

Before upgrading:
1. **Audit the new implementation**: Security review required
2. **Test on testnet**: Verify upgrade works correctly
3. **Communicate changes**: Inform protocols and whitehats
4. **Plan rollback**: Have a contingency if issues arise

## Governance Best Practices

### Parameter Changes

1. **Propose**: Submit proposal with rationale
2. **Discuss**: Allow community input
3. **Vote**: If formal vote required
4. **Timelock**: Consider delay before execution
5. **Execute**: Make the change
6. **Communicate**: Announce the change

### Emergency Actions

For urgent situations (e.g., instant promotion):

1. **Act first**: Emergency measures may require immediate action
2. **Document**: Record what was done and why
3. **Communicate**: Inform community as soon as possible
4. **Review**: Post-mortem to improve processes

### Transparency

Maintain transparency by:
- Publishing all governance decisions
- Recording rationale for parameter changes
- Providing advance notice when possible
- Creating clear documentation of current parameters

<Card title="Contract Reference" icon="book" href="/contracts/reference">
  View the complete contract API reference
</Card>
