---
title: "Claiming Your Bounty"
description: "Understanding bounty terms, caps, and claiming process"
---

Each Safe Harbor agreement defines specific bounty terms. Understanding these terms ensures you receive fair compensation for your work.

## Bounty Terms Structure

```solidity
struct BountyTerms {
    uint256 bountyPercentage;      // 0-100, percentage of recovered funds
    uint256 bountyCapUsd;          // Maximum bounty per whitehat in USD
    bool retainable;               // Can you keep bounty from recovered funds?
    IdentityRequirements identity; // KYC requirements
    string diligenceRequirements;  // Additional requirements for Named identity
    uint256 aggregateBountyCapUsd; // Total cap across all whitehats (0 = no limit)
}
```

## Bounty Calculation

### Basic Formula

```
Bounty = min(RecoveredValue × BountyPercentage%, BountyCapUsd)
```

### Examples

<Tabs>
  <Tab title="Under Cap">
    **Recovered**: $500,000
    **Bounty %**: 10%
    **Cap**: $5,000,000

    ```
    Calculated: $500,000 × 10% = $50,000
    Cap: $5,000,000
    Your Bounty: $50,000 (under cap)
    ```
  </Tab>
  <Tab title="At Cap">
    **Recovered**: $100,000,000
    **Bounty %**: 10%
    **Cap**: $5,000,000

    ```
    Calculated: $100,000,000 × 10% = $10,000,000
    Cap: $5,000,000
    Your Bounty: $5,000,000 (capped)
    ```
  </Tab>
  <Tab title="High Percentage">
    **Recovered**: $1,000,000
    **Bounty %**: 25%
    **Cap**: $1,000,000

    ```
    Calculated: $1,000,000 × 25% = $250,000
    Cap: $1,000,000
    Your Bounty: $250,000 (under cap)
    ```
  </Tab>
</Tabs>

## Retainable vs Return-All

<CardGroup cols={2}>
  <Card title="Retainable (retainable = true)" icon="hand-holding-dollar">
    **You keep your bounty from the recovered funds.**

    1. Execute attack, recover funds
    2. Calculate your bounty
    3. Keep bounty amount
    4. Send remainder to recovery address

    *Simpler for whitehats, funds handled atomically*
  </Card>
  <Card title="Return-All (retainable = false)" icon="arrows-rotate">
    **You return all funds, protocol pays bounty separately.**

    1. Execute attack, recover funds
    2. Send ALL funds to recovery address
    3. Contact protocol with proof of attack
    4. Protocol pays your bounty separately

    *More trust required, but works better for aggregate caps*
  </Card>
</CardGroup>

## Aggregate Bounty Cap

Some agreements limit total bounty payouts across all whitehats:

```solidity
// If aggregateBountyCapUsd = 10,000,000
// And three whitehats each recover $50M (10% bounty = $5M each)
// Total claimed: $15M > $10M aggregate cap

// The whitehats would share the $10M proportionally:
// Each whitehat: $10M / 3 = $3.33M
```

<Note>
Aggregate caps cannot be used with `retainable = true` because it's impossible to enforce on-chain.
</Note>

## Reading Bounty Terms

```solidity
// Get the agreement for a contract
address agreementAddr = attackRegistry.getAgreementForContract(targetContract);
IAgreement agreement = IAgreement(agreementAddr);

// Get bounty terms
BountyTerms memory terms = agreement.getBountyTerms();

// Check key values
uint256 percentage = terms.bountyPercentage;  // e.g., 10 for 10%
uint256 cap = terms.bountyCapUsd;             // e.g., 5_000_000 for $5M
bool canRetain = terms.retainable;            // true = keep from recovered
IdentityRequirements identity = terms.identity;
```

## Converting USD Caps to Tokens

Bounty caps are in USD. You'll need to convert based on current prices:

```solidity
// Example: Converting $5M cap to ETH at $2000/ETH
uint256 capUsd = 5_000_000;
uint256 ethPrice = 2000;  // Get from oracle
uint256 capInEth = capUsd / ethPrice;  // 2,500 ETH

// Your bounty in ETH cannot exceed capInEth
```

<Warning>
The agreement doesn't specify which oracle to use for price conversion. Document your methodology in case of disputes.
</Warning>

## Recovery Address

Always send funds to the correct recovery address:

```solidity
// Get the recovery address for BattleChain
string memory recoveryAddr = agreement.getAssetRecoveryAddress("eip155:325");

// Parse to native address (helper needed)
address recovery = parseAddress(recoveryAddr);

// Send recovered funds minus bounty
uint256 toReturn = recoveredAmount - yourBounty;
payable(recovery).transfer(toReturn);
```

## Dispute Resolution

If there's a disagreement about bounty amounts:

1. **Document everything**: Keep transaction hashes, calculations, timestamps
2. **Contact the protocol**: Use the contact details in the agreement
3. **Provide evidence**: Show your work calculating the bounty
4. **Involve the DAO**: As a last resort, the DAO can arbitrate disputes

## Tax Considerations

<Warning>
Bounties are likely taxable income in most jurisdictions. Consult a tax professional about your obligations.
</Warning>

Keep records of:
- Date of attack
- Assets recovered (types and amounts)
- Bounty received (types and amounts)
- USD value at time of receipt
- Recovery address transactions

<Card title="Next: Safe Harbor Protection" icon="arrow-right" href="/whitehats/safe-harbor">
  Learn about the legal protections provided by Safe Harbor
</Card>
